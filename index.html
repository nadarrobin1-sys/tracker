<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trade Journal Pro 2026</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#000;
  color:#e5e5e5;
}
header{
  padding:15px;
  text-align:center;
  border-bottom:1px solid #222;
}
.tabs{display:flex;background:#0f0f0f;}
.tabs button{
  flex:1;
  padding:10px;
  background:#0f0f0f;
  color:#777;
  border:none;
  cursor:pointer;
}
.tabs button.active{
  color:#0f0;
  border-bottom:2px solid #0f0;
}
.month{display:none;padding:20px;}
.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  max-width:900px;
  margin:auto;
}
.weekday{
  text-align:center;
  color:#555;
}

.day{
  min-height:90px;
  padding:6px;
  border:1px solid #222;
  cursor:pointer;
  font-size:12px;
}
.day.selected{outline:2px solid #fff;}
.day.profit{background:#002200;}
.day.loss{background:#220000;}

.day-num{
  font-weight:bold;
  font-size:14px;
}
.day-info{
  margin-top:6px;
  font-size:12px;
  line-height:1.3;
}

.graph-box{
  max-width:900px;
  margin:20px auto;
  border:1px solid #222;
  padding:15px;
}

.popup,.overlay{display:none;position:fixed;}
.overlay{
  inset:0;
  background:rgba(0,0,0,.8);
}
.popup{
  top:10%;
  left:50%;
  transform:translateX(-50%);
  width:420px;
  background:#000;
  border:1px solid #333;
  padding:15px;
}

table{width:100%;border-collapse:collapse;}
td{border:1px solid #333;padding:5px;}
input,select{
  width:100%;
  background:#000;
  color:#0f0;
  border:1px solid #333;
}
button{
  background:#111;
  color:#0f0;
  border:1px solid #333;
  padding:6px;
  margin:4px;
}
</style>
</head>

<body>

<header>
<h2>ðŸ“Š Trade Journal Pro 2026</h2>
</header>

<div class="tabs" id="tabs"></div>
<div id="months"></div>

<div class="graph-box">
<h3>ðŸ“Š Trades of Selected Day</h3>
<canvas id="dailyChart"></canvas>
</div>

<div class="overlay" id="overlay"></div>
<div class="popup" id="popup">
<h3 id="popupDate"></h3>
<table id="entries">
<tr>
<td>Entry</td><td>Exit</td><td>P/L</td><td>Type</td><td>Lot</td><td></td>
</tr>
</table>
<button onclick="addRow()">ADD</button>
<button onclick="saveData()">SAVE</button>
<button onclick="closePopup()">CLOSE</button>
</div>

<script>
const YEAR=2026;
const monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
const daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];
const weekDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];

let selectedKey=null;
let dailyChart;

const tabs=document.getElementById("tabs");
const monthsDiv=document.getElementById("months");
const popup=document.getElementById("popup");
const overlay=document.getElementById("overlay");
const popupDate=document.getElementById("popupDate");
const entries=document.getElementById("entries");

/* BUILD CALENDAR */
monthNames.forEach((m,i)=>{
  let b=document.createElement("button");
  b.textContent=m;
  b.onclick=()=>showMonth(i);
  tabs.appendChild(b);

  let div=document.createElement("div");
  div.className="month";
  div.id="m"+i;

  let cal=document.createElement("div");
  cal.className="calendar";

  weekDays.forEach(w=>{
    let d=document.createElement("div");
    d.className="weekday";
    d.textContent=w;
    cal.appendChild(d);
  });

  let fd=new Date(YEAR,i,1).getDay();
  for(let e=0;e<fd;e++) cal.appendChild(document.createElement("div"));

  for(let d=1;d<=daysInMonth[i];d++){
    let key=`${m}${d}`;
    let cell=document.createElement("div");
    cell.className="day";
    cell.innerHTML=`<div class="day-num">${d}</div><div class="day-info"></div>`;

    cell.onclick=()=>{
      document.querySelectorAll(".day").forEach(x=>x.classList.remove("selected"));
      cell.classList.add("selected");
      selectedKey=key;
      buildDailyChart(key);
    };

    cell.ondblclick=()=>openPopup(key);

    updateDayCell(cell,key);
    cal.appendChild(cell);
  }

  div.appendChild(cal);
  monthsDiv.appendChild(div);
});

/* UPDATE DAY CELL */
function updateDayCell(cell,key){
  cell.classList.remove("profit","loss");
  let info=cell.querySelector(".day-info");
  info.innerHTML="";

  let s=JSON.parse(localStorage.getItem(key))||[];
  if(!s.length) return;

  let total=s.reduce((a,b)=>a+Number(b.profit||0),0);
  total=Number(total).toFixed(3);

  info.innerHTML=`
    ${s.length} trade${s.length>1?"s":""}<br>
    <span style="color:${total>=0?"#00ff55":"#ff3333"}">
      ${total>=0?"+":""}${total}
    </span>
  `;

  cell.classList.add(total>=0?"profit":"loss");
}

/* DAILY CHART */
function buildDailyChart(key){
  let s=JSON.parse(localStorage.getItem(key))||[];
  let data=s.map(t=>Number(t.profit).toFixed(3));
  let colors=data.map(v=>v>=0?"#00ff55":"#ff3333");

  if(dailyChart) dailyChart.destroy();
  dailyChart=new Chart(dailyChartCtx,{
    type:"bar",
    data:{
      labels:data.map((_,i)=>`Trade ${i+1}`),
      datasets:[{data,backgroundColor:colors}]
    },
    options:{plugins:{legend:{display:false}}}
  });
}

/* POPUP */
function openPopup(key){
  selectedKey=key;
  popupDate.textContent=key;
  entries.innerHTML=`<tr>
  <td>Entry</td><td>Exit</td><td>P/L</td><td>Type</td><td>Lot</td><td></td></tr>`;
  let s=JSON.parse(localStorage.getItem(key))||[];
  s.forEach(t=>addRow(t.entry,t.exit,t.profit,t.type,t.lot));
  popup.style.display=overlay.style.display="block";
}
function closePopup(){
  popup.style.display=overlay.style.display="none";
  refreshCalendar();
}

/* ROWS */
function addRow(e="",x="",p="",t="Long",l="0.01"){
  let r=document.createElement("tr");
  r.innerHTML=`
  <td><input value="${e}"></td>
  <td><input value="${x}"></td>
  <td><input type="number" step="0.001" value="${Number(p||0).toFixed(3)}"></td>
  <td><select><option ${t=="Long"?"selected":""}>Long</option><option ${t=="Short"?"selected":""}>Short</option></select></td>
  <td><input type="number" step="0.01" value="${l}"></td>
  <td><button onclick="this.closest('tr').remove()">âœ–</button></td>`;
  entries.appendChild(r);
}

function saveData(){
  let rows=[...entries.querySelectorAll("tr")].slice(1);
  let data=rows.map(r=>{
    let i=r.querySelectorAll("input,select");
    return{
      entry:i[0].value,
      exit:i[1].value,
      profit:Number(i[2].value).toFixed(3),
      type:i[3].value,
      lot:i[4].value
    };
  });

  if(data.length)
    localStorage.setItem(selectedKey,JSON.stringify(data));
  else
    localStorage.removeItem(selectedKey);

  closePopup();
  buildDailyChart(selectedKey);
}

/* REFRESH CALENDAR */
function refreshCalendar(){
  document.querySelectorAll(".day").forEach(cell=>{
    let d=cell.querySelector(".day-num").textContent;
    let m=document.querySelector(".tabs button.active").textContent;
    updateDayCell(cell,`${m}${d}`);
  });
}

/* INIT */
const dailyChartCtx=document.getElementById("dailyChart");
function showMonth(i){
  document.querySelectorAll(".month").forEach(x=>x.style.display="none");
  document.querySelectorAll(".tabs button").forEach(x=>x.classList.remove("active"));
  document.getElementById("m"+i).style.display="block";
  tabs.children[i].classList.add("active");
}
showMonth(0);
</script>

</body>
</html>
